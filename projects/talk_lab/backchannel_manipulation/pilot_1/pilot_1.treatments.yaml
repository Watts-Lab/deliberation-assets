templates:
  - templateName: storytelling_round
    contentType: stages
    templateContent:
      - name: pre_instructions
        duration: 60
        elements:
          - type: prompt
            file: projects/talk_lab/backchannel_manipulation/pilot_1/game/${condition}/listener_pre_instructions.md
            showToPositions: [0, 2, 4]
          - type: prompt
            file: projects/talk_lab/backchannel_manipulation/pilot_1/game/speaker_pre_instructions.md
            showToPositions: [1, 3, 5]
          - type: submitButton
            buttonText: "Continue to the call"

      - name: storytelling
        duration: 300
        discussion:
          chatType: video
          showNickname: true
          showTitle: true
          # rooms:
          #   - ${roomAssignments}

        elements:
          - type: prompt
            file: projects/talk_lab/backchannel_manipulation/pilot_1/game/${condition}/listener_in_instructions.md
            showToPositions: [0, 2, 4]
          - type: prompt
            file: projects/talk_lab/backchannel_manipulation/pilot_1/game/speaker_in_instructions.md
            showToPositions: [1, 3, 5]
          - type: submitButton
            buttonText: "End the call and start questions"

      - name: post_story_questions
        duration: 120
        elements:
          - type: prompt
            file: projects/talk

  - templateName: game
    contentType: treatments
    templateContent:
      - name: ${first_condition}_${second_condition}_${third_condition}
        playerCount: 6
        groupComposition:
          - position: 0
            title: Listener
          - position: 1
            title: Storyteller
          - position: 2
            title: Listener
          - position: 3
            title: Storyteller
          - position: 4
            title: Listener
          - position: 5
            title: Storyteller

        gameStages:
          - name: practice_instructions
            duration: 60
            elements:
              - type: prompt
                file: projects/talk_lab/backchannel_manipulation/pilot_1/game/practice/speaker_practice_pre_instructions.md
                showToPositions: [1, 3, 5]
              - type: prompt
                file: projects/talk_lab/backchannel_manipulation/pilot_1/game/practice/listener_practice_pre_instructions.md
                showToPositions: [0, 2, 4]
              - type: submitButton
                buttonText: "Continue"

          - name: practice_call
            duration: 180
            discussion:
              chatType: video
              showNickname: true
              showTitle: true
              # rooms:
              #   - name: practice_speaker_room_A
              #     includePositions: [1]
              #   - name: practice_speaker_room_B
              #     includePositions: [3]
              #   - name: practice_speaker_room_C
              #     includePositions: [5]
              # Q: how do we hide the call interface from the others? add a "showToPositions" field to the discussion, and not render the discussion for those positions?
            elements:
              - type: prompt
                file: projects/talk_lab/backchannel_manipulation/pilot_1/game/practice/speaker_practice_in_instructions.md
                showToPositions: [1, 3, 5]
              - type: prompt
              - type: video # a demo video showing how people do these things
                url: https://youtu.be/R1qo5BxnXSw?si=ZE8qh_q84qhpg_iT # replace with actual video url
                showToPositions: [0, 2, 4]
              - type: submitButton
                buttonText: "End the practice call and start questions"

          - template: storytelling_round
            broadcast:
              d0:
                - condition: ${first_condition}
                  roomAssignments:
                    - name: A
                      includePositions: [0, 1]
                    - name: B
                      includePositions: [2, 3]
                    - name: C
                      includePositions: [4, 5]
                - condition: ${second_condition}
                  roomAssignments:
                    - name: A
                      includePositions: [0, 3]
                    - name: B
                      includePositions: [2, 5]
                    - name: C
                      includePositions: [4, 1]
                - condition: ${third_condition}
                  roomAssignments:
                    - name: A
                      includePositions: [0, 5]
                    - name: B
                      includePositions: [2, 1]
                    - name: C
                      includePositions: [4, 3]

        exitSequence:
          - name: Demographics
            elements:
              - type: survey
                name: demographics
                surveyName: DemographicsShortUS

introSequences:
  - name: default
    introSteps:
      - name: Big-5 # 10 questions
        elements:
          - type: survey
            name: big5Personality
            surveyName: TIPI

      - name: Instructions
        elements:
          - type: prompt
            file: projects/talk_lab/backchannel_manipulation/pilot_1/intro/introduction.md
          - type: submitButton
            buttonText: "Begin"

treatments:
  - template: game
    broadcast:
      d0:
        - first_condition: expressive
          second_condition: minimal
          third_condition: distracted
        - first_condition: expressive
          second_condition: distracted
          third_condition: minimal
        - first_condition: minimal
          second_condition: expressive
          third_condition: distracted
        - first_condition: minimal
          second_condition: distracted
          third_condition: expressive
        - first_condition: distracted
          second_condition: expressive
          third_condition: minimal
        - first_condition: distracted
          second_condition: minimal
          third_condition: expressive
