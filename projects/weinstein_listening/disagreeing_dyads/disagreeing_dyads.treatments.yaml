templates:

# one person in dyad is never given a goal
# in condition A the other is assigned to persuade
# in condition B the other is assigned to learn

  - templateName: disagreeing_dyads
    templateDesc: Main experiment template 
    templateContent:
      name: "${learningOrPersuasion}_condition"
      playerCount: 2 
      # don't care about who gets assigned to which position
      # position 0 "goal absent" 
      # position 1A "persuade"
      # position 1B "learn"

      gameStages:
        - name: # TODO
          duration: 300
          elements:

        - name: Strategies and Filler
          duration: 180
          elements:
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/please_wait.md
              showToPositions: [0] # ask pos 0 to wait while pos 1 writes about learning/persuading

            
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/topic_introduction.md
              showToPositions: [1]
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/bathroom_choice_discussion.md    
              conditions:
                # TODO - work out how to show the topic of maximal disagreement here
            - type: prompt
              file: "projects/weinstein_listening/disagreeing_dyads/${learningOrPersuasion}_utility.md" # learningOrPersuasion takes [learning, persuasion]
              showToPositions: [1]

            - type: submitButton
              displayTime: 120
              buttonText: Continue
         
        - name: Opinion Notes
          duration: 180
          elements:
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/topic_introduction.md
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/bathroom_choice_discussion.md    
              conditions:
                # TODO - work out how to show the topic of maximal disagreement here
            
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/reflection_instructions_goal_absent.md
              showToPositions: [0]
              name: reflection_goal_absent
            - type: prompt
              file: "projects/weinstein_listening/disagreeing_dyads/reflection_instructions_${learningOrPersuasion}_goal.md" # learningOrPersuasion takes [learning, persuasion]
              showToPositions: [1]
              name: reflection_goal_present

            - type: submitButton
              displayTime: 120
              buttonText: Continue
              
        - name: Attitude Attributes
          duration: 90
          elements:
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/attitude_attributes_introduction.md

            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/bathroom_choice_discussion.md    
              conditions:
                # TODO - work out how to show the topic of maximal disagreement here

            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/presurvey/topic_attitude.md
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/presurvey/topic_importance.md
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/presurvey/topic_knowledge.md

            - type: submitButton
              buttonText: Continue    

        - name: Conversation Expectations
          duration: 120
          elements:
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/conversation_expectations.md

            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/presurvey/discussion_expected_enjoyment.md
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/presurvey/discussion_expected_get_along.md
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/presurvey/discussion_expected_smooth.md
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/presurvey/discussion_expected_learning.md
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/presurvey/discussion_expected_attitude_change.md
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/presurvey/discussion_expected_partner_attitude_change.md

            - type: submitButton
              buttonText: Continue      
          
        - name: Pre-discussion Reminder
          duration: 60
          elements:
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/pre_discussion_reminder_A_Goal_Absent.md
              showToPositions: [0]
            - type: prompt
              file: "projects/weinstein_listening/disagreeing_dyads/pre_discussion_reminder_A_${learningOrPersuasion}_goal.md" # learningOrPersuasion takes [learning, persuasion]
              showToPositions: [1]

            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/bathroom_choice_discussion.md    
              conditions:
                # TODO - work out how to show the topic of maximal disagreement here

            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/pre_discussion_reminder_B_Goal_Absent.md
              showToPositions: [0]
            - type: prompt
              file: "projects/weinstein_listening/disagreeing_dyads/pre_discussion_reminder_B_${learningOrPersuasion}_goal.md" # learningOrPersuasion takes [learning, persuasion]
              showToPositions: [1]

            - type: display
              reference: prompt.reflection_goal_absent
              showToPositions: [0]
            - type: display
              reference: prompt.reflection_goal_present
              showToPositions: [1]

            - type: submitButton
              buttonText: Continue

        - name: Discussion
          duration: 600 # always exactly 10 mins
          discussion:
            chatType: video
            showNickname: true
            showTitle: false
          elements:
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/discussion_instructions_5min.md
              displayTime: 300
              hideTime: 330

            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/discussion_instructions_8min.md
              displayTime: 480
              hideTime: 510
              
            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/discussion_instructions_A.md

            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/bathroom_choice_discussion.md    
              conditions:
                # TODO - work out how to show the topic of maximal disagreement here

            - type: prompt
              file: projects/weinstein_listening/disagreeing_dyads/discussion_instructions_A.md

            - type: display
              reference: prompt.reflection_goal_absent
              showToPositions: [0]
            - type: display
              reference: prompt.reflection_goal_present
              showToPositions: [1]

      exitSequence:
        - name: PostDiscussionInstructions
          elements:
            - type: prompt
              file: projects/css_lab/ct_topic/post_discussion_instructions.md
            - type: submitButton
              buttonText: Proceed to Survey

        

introSequences:
  - name: default
    introSteps:
     # - name: self_construal
      #  elements:
          - # TODO - implement as canned survey
      - name: topic_survey
        elements:
          - type: prompt
            file: projects/weinstein_listening/disagreeing_dyads/presurvey_instructions.md
          - type: prompt
            file: projects/weinstein_listening/disagreeing_dyads/topics/restricting_legal_abortion.md
            name: restricting_legal_abortion
          - type: prompt
            file: projects/weinstein_listening/disagreeing_dyads/topics/restricting_immigrants.md
            name: restricting_immigrants
          - type: prompt
            file: projects/weinstein_listening/disagreeing_dyads/topics/privatise_NHS.md
            name: privatise_NHS
          - type: prompt
            file: projects/weinstein_listening/disagreeing_dyads/topics/remote_classes.md
            name: remote_classes
          - type: prompt
            file: projects/weinstein_listening/disagreeing_dyads/topics/raise_cost_of_uni.md
            name: raise_cost_of_uni
          - type: prompt 
            file: projects/weinstein_listening/disagreeing_dyads/topics/bathroom_choice.md
            name: bathroom_choice
          - type: prompt 
            file: projects/weinstein_listening/disagreeing_dyads/topics/education_employability.md
            name: education_employability
          - type: prompt 
            file: projects/weinstein_listening/disagreeing_dyads/topics/censoring_extremism.md
            name: censoring_extremism



 

treatments:
  - template: disagreeing_dyads
    fields:
      # none?
    broadcast:
      d0:
        - learningOrPersuasion: learning
        - learningOrPersuasion: persuasion
        
    

  