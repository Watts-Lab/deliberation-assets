introSequences:
  - name: default
    introSteps:
      - name: presurvey
        elements:
          - type: qualtrics
            url: https://oii.qualtrics.com/jfe/form/SV_cSkkngvdYj5mRF4
      - name: topics
        elements:
          - type: prompt
            file: projects/weinstein_listening/safak_text_dyads/intro/presurvey_intro.md

          - type: prompt
            file: projects/weinstein_listening/safak_text_dyads/topics/assisted_suicide_survey.md
            name: assisted_suicide_presurvey

          - type: prompt
            file: projects/weinstein_listening/safak_text_dyads/topics/healthcare_strike_survey.md
            name: healthcare_strike_presurvey

          - type: prompt
            file: projects/weinstein_listening/safak_text_dyads/topics/trans_bathroom_survey.md
            name: trans_bathroom_presurvey

          - type: prompt
            file: projects/weinstein_listening/safak_text_dyads/topics/undisclosed_AI_survey.md
            name: undisclosed_AI_presurvey

          - type: prompt
            file: projects/weinstein_listening/safak_text_dyads/topics/climate_emergency_survey.md
            name: climate_emergency_presurvey

          - type: submitButton
            buttonText: Submit

templates:
  - templateName: condition
    contentType: treatment
    templateContent:
      name: ${treatmentName}
      playerCount: 2
      groupComposition:
        - position: 0
          conditions:
            - reference: prompt.${topicName}_presurvey
              comparator: isOneOf
              value: ${p0_stance}
        - position: 1
          conditions:
            - reference: prompt.${topicName}_presurvey
              comparator: isOneOf
              value: ${p1_stance}

      gameStages:
        - name: instructions
          duration: 45
          elements:
            - type: prompt
              file: projects/weinstein_listening/safak_text_dyads/game/p0_pre_instructions_${p0_condition}.md
              showToPositions: [0]
            - type: prompt
              file: projects/weinstein_listening/safak_text_dyads/game/p1_pre_instructions.md
              showToPositions: [1]
            - type: submitButton
              buttonText: Proceed to chat

        - name: chat
          duration: 300
          discussion:
            chatType: text
            showNickname: true
            showTitle: false
            reactionEmojisAvailable:
              [
                "üòä",
                "üò≠",
                "üòÇ",
                "‚ù§Ô∏è",
                "‚ú®",
                "‚≠ê",
                "üéâ",
                "üî•",
                "üíØ",
                "üëçüèª",
                "üëéüèª",
                "‚úÖ",
                "‚ùå",
                "üíÄ",
                "üëÄ",
              ]
            reactToSelf: false
            numReactionsPerMessage: 1
          elements:
            - type: prompt
              file: projects/weinstein_listening/safak_text_dyads/game/p0_in_instructions_${p0_condition}.md
              showToPositions: [0]
            - type: prompt
              file: projects/weinstein_listening/safak_text_dyads/game/p1_in_instructions.md
              showToPositions: [1]
            - type: prompt
              file: projects/weinstein_listening/safak_text_dyads/topics/${topicName}_discussion.md
              showToPositions: [1]

      exitSequence:
        - name: postsurvey
          elements:
            - type: qualtrics
              url: https://oii.qualtrics.com/jfe/form/SV_5teFqZBYIiR9BSm

treatments:
  - template: condition
    fields:
      treatmentName: "t_${p0_condition}_${topicName}_p0_${p0_direction}_p1_${p1_direction}"
    broadcast:
      d0:
        - p0_stance: ["1 - Extremely Negative", "2 - Moderately Negative"] # opposite stance, treated individual is negative
          p1_stance: ["6 - Moderately Positive", "7 - Extremely Positive"]
          p0_direction: "negative"
          p1_direction: "positive"
        - p0_stance: ["6 - Moderately Positive", "7 - Extremely Positive"] # opposite stance, treated individual is positive
          p1_stance: ["1 - Extremely Negative", "2 - Moderately Negative"]
          p0_direction: "positive"
          p1_direction: "negative"
        - p0_stance: ["6 - Moderately Positive", "7 - Extremely Positive"] # same stance, positive
          p1_stance: ["6 - Moderately Positive", "7 - Extremely Positive"]
          p0_direction: "positive"
          p1_direction: "positive"
        - p0_stance: ["1 - Extremely Negative", "2 - Moderately Negative"] # same stance, negative
          p1_stance: ["1 - Extremely Negative", "2 - Moderately Negative"]
          p0_direction: "negative"
          p1_direction: "negative"

      d1:
        - topicName: "assisted_suicide"
        - topicName: "healthcare_strike"
        - topicName: "trans_bathroom"
        - topicName: "undisclosed_AI"
        - topicName: "climate_emergency"
      d2:
        - p0_condition: "listener"
        - p0_condition: "expressor"
